<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RUNNER_001 | Performance Hub</title>
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Prompt:wght@300;400;500&display=swap" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            /* --- COLOR PALETTE (WHOOP STYLE) --- */
            --bg-body: #050505;
            --bg-card: #121212;
            --bg-nav: #000000;
            --bg-input: #1A1A1A;
            
            --whoop-green: #34D399;
            --whoop-red: #F87171;
            --whoop-yellow: #FBBF24;
            --whoop-blue: #60A5FA;
            
            --text-main: #E5E5E5;
            --text-sub: #A3A3A3;
            --border-color: #262626;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', 'Prompt', sans-serif; font-weight: 300; }
        body { background-color: var(--bg-body); color: var(--text-main); height: 100vh; overflow: hidden; display: flex; }
        
        /* Utils */
        .text-uppercase { text-transform: uppercase; letter-spacing: 1.5px; font-size: 10px; font-weight: 600; color: var(--text-sub); margin-bottom: 5px; }
        .highlight-green { color: var(--whoop-green); }
        .highlight-red { color: var(--whoop-red); }
        .highlight-yellow { color: var(--whoop-yellow); }
        .text-justify { text-align: justify; line-height: 1.8; }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-body); }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }

        /* Sidebar Navigation */
        .sidebar { 
            width: 90px; background-color: var(--bg-nav); border-right: 1px solid var(--border-color); 
            display: flex; flex-direction: column; align-items: center; padding: 30px 0; flex-shrink: 0; z-index: 100; 
        }
        .brand-icon { 
            font-size: 28px; margin-bottom: 40px; cursor: pointer; transition: 0.3s;
            background: linear-gradient(135deg, var(--whoop-green), var(--whoop-blue));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            position: relative;
            transform: scaleX(-1); 
            display: inline-block;
        }
        .brand-icon:hover { transform: scaleX(-1) scale(1.1); filter: drop-shadow(0 0 8px rgba(52, 211, 153, 0.4)); }

        .brand-icon::after {
            content: "HOME";
            position: absolute;
            bottom: -18px;
            left: 50%;
            transform: translateX(-50%) scaleX(-1);
            font-size: 8px;
            color: var(--text-sub);
            letter-spacing: 1px;
            opacity: 0;
            transition: 0.3s;
            pointer-events: none;
        }
        .brand-icon:hover::after { opacity: 1; bottom: -22px; }

        .nav-menu { list-style: none; display: flex; flex-direction: column; gap: 30px; width: 100%; align-items: center; }
        .nav-item { 
            width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center; 
            color: var(--text-sub); cursor: pointer; transition: 0.3s; font-size: 20px; position: relative;
        }
        .nav-item:hover { color: white; background: #1a1a1a; transform: translateY(-2px); }
        .nav-item.active { 
            color: var(--whoop-green); background: rgba(52, 211, 153, 0.1); 
            font-weight: 400; box-shadow: 0 0 15px rgba(52, 211, 153, 0.1); 
        }
        
        .nav-item:hover::after {
            content: attr(title); position: absolute; left: 60px; background: #222; padding: 6px 12px; 
            border-radius: 6px; font-size: 12px; white-space: nowrap; z-index: 200; border: 1px solid #444; color: white;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5); pointer-events: none;
        }

        /* Main Content Area */
        .main-container { flex-grow: 1; padding: 40px 60px; overflow-y: auto; }
        .section-view { display: none; animation: fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        .section-view.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        /* Components */
        .header-section { margin-bottom: 40px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        .page-title { font-size: 28px; color: white; font-weight: 500; letter-spacing: -0.5px; }
        .subtitle { color: var(--text-sub); margin-top: 5px; font-size: 14px; }
        
        .accordion-card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; margin-bottom: 20px; overflow: hidden; transition: 0.2s; }
        .accordion-header { padding: 25px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; background: var(--bg-card); border-bottom: 1px solid transparent; }
        .accordion-header:hover { background: #181818; }
        .accordion-card.open { border-color: var(--whoop-green); }
        .accordion-card.open .accordion-header { border-bottom: 1px solid var(--border-color); background: #151515; }
        .accordion-card.open .accordion-icon { transform: rotate(180deg); }
        .accordion-body { display: none; padding: 25px 30px; background: #0a0a0a; }

        /* Stats Grid for Evolution */
        .stats-grid-row {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; 
            margin-bottom: 15px; background: #111; padding: 15px; border-radius: 8px; border: 1px solid #333;
        }
        .stat-item-label { font-size: 11px; color: #888; text-transform: uppercase; margin-bottom: 4px; }
        .stat-item-value { font-size: 14px; color: white; font-weight: 600; }

        /* Schedule Table */
        .schedule-table { width: 100%; border-collapse: collapse; font-size: 14px; }
        .schedule-table th { padding: 15px; text-align: left; color: var(--text-sub); border-bottom: 1px solid var(--border-color); text-transform: uppercase; font-size: 11px; letter-spacing: 1px; }
        .schedule-table td { padding: 20px 15px; border-bottom: 1px solid #222; vertical-align: top; color: var(--text-sub); line-height: 1.6; }
        .schedule-table tr:hover td { background: rgba(255,255,255,0.02); color: var(--text-main); }

        .tag { padding: 4px 10px; border-radius: 6px; font-size: 10px; font-weight: 600; text-transform: uppercase; display: inline-block; margin-bottom: 5px; }
        .tag-run { background: rgba(52, 211, 153, 0.15); color: var(--whoop-green); border: 1px solid rgba(52, 211, 153, 0.2); }
        .tag-rest { background: rgba(255, 255, 255, 0.05); color: var(--text-sub); border: 1px solid #333; }
        .tag-long { background: rgba(245, 158, 11, 0.15); color: var(--whoop-yellow); border: 1px solid rgba(245, 158, 11, 0.2); }

        /* --- HANDBOOK LAYOUT --- */
        .handbook-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
        .handbook-full-width { grid-column: 1 / -1; }
        .info-box { padding: 20px; background: rgba(255,255,255,0.03); border-radius: 8px; border-left: 3px solid var(--whoop-blue); height: 100%; }

        /* --- RECOVERY GRID --- */
        .recovery-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .recovery-card { background: #161616; padding: 20px; border-radius: 10px; border: 1px solid #222; }
        .recovery-title { color: white; font-weight: 600; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        .recovery-list { list-style: none; padding: 0; margin: 0; }
        .recovery-list li { margin-bottom: 10px; font-size: 13px; color: var(--text-sub); display: flex; align-items: flex-start; gap: 8px; }
        .recovery-list li i { color: var(--whoop-green); margin-top: 3px; font-size: 10px; }

        /* HR Zone Table */
        .hr-table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 13px; }
        .hr-table th { text-align: left; padding: 12px; background: #1a1a1a; color: var(--text-sub); font-size: 11px; text-transform: uppercase; letter-spacing: 1px;}
        .hr-table td { padding: 15px 12px; border-bottom: 1px solid #222; vertical-align: middle; }
        .hr-zone-tag { font-weight: bold; display: block; margin-bottom: 4px; font-size: 14px; }
        
        /* Log Form */
        .log-form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 15px; }
        .form-input { width: 100%; background: var(--bg-input); border: 1px solid var(--border-color); color: white; padding: 12px; border-radius: 8px; outline: none; }
        .form-input:focus { border-color: var(--whoop-green); }
        .btn-save { background: var(--whoop-green); color: black; border: none; padding: 12px; border-radius: 8px; font-weight: 600; cursor: pointer; width: 100%; transition: 0.2s; }
        .btn-save:hover { opacity: 0.9; transform: translateY(-1px); }
        
        /* New Button Style for AI Features */
        .btn-sparkle { 
            background: linear-gradient(135deg, #3b82f6, #8b5cf6); 
            color: white; border: none; padding: 12px; border-radius: 8px; font-weight: 600; cursor: pointer; width: 100%; transition: 0.2s;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .btn-sparkle:hover { filter: brightness(1.2); transform: translateY(-1px); }

        /* Log History */
        .log-history-item { background: #161616; padding: 20px; border-radius: 10px; margin-bottom: 12px; border-left: 4px solid var(--text-sub); display: flex; justify-content: space-between; align-items: center; }

        /* Timeline Navigation */
        .timeline-nav { display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; padding-bottom: 5px; }
        .timeline-btn { 
            background: #111; border: 1px solid #333; color: #666; padding: 8px 16px; border-radius: 20px; 
            font-size: 12px; cursor: pointer; white-space: nowrap; transition: 0.2s; 
        }
        .timeline-btn.active { background: var(--whoop-green); color: black; border-color: var(--whoop-green); font-weight: 600; }
        .timeline-btn.month-active { background: var(--whoop-green); color: black; border-color: var(--whoop-green); font-weight: 800; box-shadow: 0 0 10px rgba(52, 211, 153, 0.2); }
        .timeline-btn:hover:not(.active):not(.month-active) { border-color: #666; color: #aaa; }
        .timeline-year { font-weight: bold; color: white; margin-right: 10px; display: flex; align-items: center; }

        @media (max-width: 768px) {
            .sidebar { width: 100%; height: 70px; flex-direction: row; padding: 0 25px; border-right: none; border-bottom: 1px solid var(--border-color); justify-content: space-between; }
            .nav-menu { flex-direction: row; width: auto; gap: 20px; }
            .nav-item:hover::after { display: none; }
            .main-container { padding: 25px 20px; }
            .schedule-table th, .schedule-table td { display: block; width: 100%; padding: 10px 0; }
            .schedule-table th { display: none; }
            .schedule-table tr { display: block; margin-bottom: 20px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
            .hr-table { font-size: 12px; }
            .handbook-layout { grid-template-columns: 1fr; }
            .recovery-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <!-- NAVIGATION SIDEBAR -->
    <nav class="sidebar">
        <!-- Brand Icon: Acts as Home Button (Flipped Left) -->
        <div class="brand-icon" onclick="switchTab('dashboard')" title="Home">
            <i class="fas fa-running"></i>
        </div>
        
        <ul class="nav-menu">
            <!-- 1. Evolution Log (Home) -->
            <li class="nav-item active" onclick="switchTab('dashboard', this)" title="Evolution Log">
                <i class="fas fa-stream"></i>
            </li>
            <!-- 2. Schedule -->
            <li class="nav-item" onclick="switchTab('schedule', this)" title="Weekly Schedule">
                <i class="fas fa-calendar-week"></i>
            </li>
            <!-- 3. Handbook -->
            <li class="nav-item" onclick="switchTab('handbook', this)" title="Handbook & Gear">
                <i class="fas fa-shoe-prints"></i>
            </li>
            <!-- 4. Recovery (Changed from Nutrition) -->
            <li class="nav-item" onclick="switchTab('recovery', this)" title="Recovery Room">
                <i class="fas fa-child-reaching"></i>
            </li>
            <!-- 5. Daily Log -->
            <li class="nav-item" onclick="switchTab('dailylog', this)" title="Daily Log">
                <i class="fas fa-pen-to-square"></i>
            </li>
            <!-- 6. AI Coach -->
            <li class="nav-item" onclick="switchTab('ai-coach', this)" title="AI Coach">
                <i class="fas fa-robot"></i>
            </li>
        </ul>
    </nav>

    <!-- MAIN CONTENT -->
    <div class="main-container">

        <!-- VIEW 1: DASHBOARD & EVOLUTION LOG -->
        <div id="dashboard" class="section-view active">
            <div class="header-section">
                <div>
                    <div class="text-uppercase">PERFORMANCE HUB</div>
                    <h1 class="page-title" style="font-size: 24px;">üìú EVOLUTION LOG: HISTORY OF PERFORMANCE</h1>
                    <div class="subtitle" style="line-height: 1.5;">
                        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡πÄ‡∏ü‡∏™ (Data-Driven Timeline)<br>
                        <span style="color: var(--whoop-green); font-size: 12px;">(‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: 19 ‡∏°.‡∏Ñ. 2026)</span>
                    </div>
                </div>
            </div>

            <!-- WEEKLY FOCUS (Pinned) -->
            <div class="accordion-card open" style="border-color: var(--whoop-yellow);">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <div>
                        <div class="text-uppercase" style="color: var(--whoop-yellow);">WEEKLY FOCUS (19-25 JAN)</div>
                        <h3 style="color: white; font-weight: 500;">Compressed Quality Strategy</h3>
                    </div>
                    <i class="fas fa-chevron-down accordion-icon"></i>
                </div>
                <div class="accordion-body" style="display: block;">
                    <p style="color: var(--text-sub); margin-bottom: 15px;">
                        ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ï‡∏¥‡∏î‡∏ò‡∏∏‡∏£‡∏∞ ‡∏û‡∏§‡∏´‡∏±‡∏™-‡∏®‡∏∏‡∏Å‡∏£‡πå) ‡πÅ‡∏ú‡∏ô‡∏à‡∏∂‡∏á‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô <strong>"‡∏≠‡∏±‡∏î‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå + ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏î‡∏õ‡∏•‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå"</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Long Run ‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå
                    </p>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; font-size: 13px;">
                        <div class="info-box" style="border-left-color: var(--whoop-yellow);">
                            <strong style="color: white;">üéØ Main Goal</strong><br>
                            Hip Drive Awareness (‡∏à‡∏î‡∏à‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏™‡∏∞‡πÇ‡∏û‡∏Å‡∏™‡πà‡∏á‡πÅ‡∏£‡∏á ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏ô‡πà‡∏≠‡∏á)
                        </div>
                        <div class="info-box" style="border-left-color: var(--whoop-red);">
                            <strong style="color: white;">‚ö†Ô∏è Action Items</strong><br>
                            1. ‡∏Å‡∏¥‡∏ô‡πÄ‡∏à‡∏• (100kcal) ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà 40 & 80 ‡πÉ‡∏ô Long Run<br>
                            2. ‡∏ó‡∏≥ Clamshells ‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏´‡πâ‡∏≤‡∏°‡∏Ç‡∏≤‡∏î (‡∏Å‡∏±‡∏ô‡∏Å‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏ö)
                        </div>
                    </div>
                </div>
            </div>

            <!-- PHASE 3: CURRENT -->
            <div class="accordion-card open">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <div>
                        <div class="text-uppercase" style="color: var(--whoop-green);">üåï PHASE 3: CURRENT (DEC 25 - PRESENT)</div>
                        <h3 style="color: white;">Neuromuscular Awareness</h3>
                    </div>
                    <i class="fas fa-chevron-down accordion-icon"></i>
                </div>
                <div class="accordion-body" style="display: block;">
                    <p class="text-justify" style="color: var(--text-sub); margin-bottom: 15px;">
                        <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> "Efficiency Unlock" (‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ‡∏ì ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ)<br>
                        ‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ó‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠ (Mind-Muscle Connection) ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏™‡∏∞‡πÇ‡∏û‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏†‡∏≤‡∏£‡∏∞‡∏ä‡πà‡∏ß‡∏á‡∏•‡πà‡∏≤‡∏á
                    </p>
                    
                    <!-- Stats Grid -->
                    <div class="stats-grid-row">
                        <div>
                            <div class="stat-item-label">Easy Pace</div>
                            <div class="stat-item-value highlight-green">7:05 - 7:20 /km</div>
                        </div>
                        <div>
                            <div class="stat-item-label">Avg HR</div>
                            <div class="stat-item-value">140 - 150 bpm</div>
                        </div>
                        <div>
                            <div class="stat-item-label">Cadence</div>
                            <div class="stat-item-value">165 - 172 spm</div>
                        </div>
                        <div>
                            <div class="stat-item-label">GCT</div>
                            <div class="stat-item-value">270 - 280 ms</div>
                        </div>
                    </div>

                    <div class="info-box" style="border-left-color: var(--whoop-green);">
                        <strong style="color: white;">üí° Key Learning</strong><br>
                        "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏°‡∏≤‡πÄ‡∏≠‡∏á" ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏ô, ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏™‡∏∞‡πÇ‡∏û‡∏Å‡∏ã‡πâ‡∏≤‡∏¢, ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ß‡∏¥‡πà‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ó
                    </div>
                </div>
            </div>

            <!-- PHASE 2: COMPLETED -->
            <div class="accordion-card">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <div>
                        <div class="text-uppercase">üåó PHASE 2: COMPLETED (NOV - DEC 2025)</div>
                        <h3 style="color: white;">Aerobic Base Formation</h3>
                    </div>
                    <i class="fas fa-chevron-down accordion-icon"></i>
                </div>
                <div class="accordion-body">
                    <p class="text-justify" style="color: var(--text-sub); margin-bottom: 15px;">
                        <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡πÇ‡∏£‡∏ö‡∏¥‡∏Å‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á (Base ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏°‡∏µ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠)<br>
                        ‡∏ä‡πà‡∏ß‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô ‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏¢‡∏∞‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏Ç‡∏≤‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô
                    </p>
                    
                    <div class="stats-grid-row">
                        <div>
                            <div class="stat-item-label">Easy Pace</div>
                            <div class="stat-item-value">7:40 - 7:50 /km</div>
                        </div>
                        <div>
                            <div class="stat-item-label">Avg HR</div>
                            <div class="stat-item-value">140 - 150 bpm</div>
                        </div>
                        <div>
                            <div class="stat-item-label">Cadence</div>
                            <div class="stat-item-value">155 ‚Üí 162 spm</div>
                        </div>
                        <div>
                            <div class="stat-item-label">GCT</div>
                            <div class="stat-item-value">280 - 300 ms</div>
                        </div>
                    </div>

                    <div class="info-box" style="border-left-color: var(--whoop-yellow);">
                        <strong style="color: white;">üí° Key Learning</strong><br>
                        ‡∏ß‡∏¥‡πà‡∏á‡πÑ‡∏î‡πâ‡∏ô‡∏≤‡∏ô 75-100 ‡∏ô‡∏≤‡∏ó‡∏µ ‡πÅ‡∏ï‡πà‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏´‡∏°‡∏î‡πÑ‡∏ß (Body Battery Drop ‡πÄ‡∏£‡πá‡∏ß), ‡πÄ‡∏ó‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÅ‡∏ä‡πà‡∏û‡∏∑‡πâ‡∏ô‡∏ô‡∏≤‡∏ô
                    </div>
                </div>
            </div>

            <!-- PHASE 1: COMPLETED -->
            <div class="accordion-card">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <div>
                        <div class="text-uppercase">üåò PHASE 1: COMPLETED (SEP - OCT 2025)</div>
                        <h3 style="color: white;">Aerobic Familiarization</h3>
                    </div>
                    <i class="fas fa-chevron-down accordion-icon"></i>
                </div>
                <div class="accordion-body">
                    <p class="text-justify" style="color: var(--text-sub); margin-bottom: 15px;">
                        <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏°‡∏µ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á ‡πÅ‡∏ï‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ô‡∏¥‡πà‡∏á<br>
                        ‡∏ä‡πà‡∏ß‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏ô‡πÄ‡∏Ñ‡∏¢‡∏Å‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ù‡∏∂‡∏Å‡∏ã‡πâ‡∏≠‡∏°
                    </p>
                    
                    <div class="stats-grid-row">
                        <div>
                            <div class="stat-item-label">Easy Pace</div>
                            <div class="stat-item-value">8:30 - 9:00 /km</div>
                        </div>
                        <div>
                            <div class="stat-item-label">Avg HR</div>
                            <div class="stat-item-value highlight-red">145 - 155 bpm</div>
                        </div>
                        <div>
                            <div class="stat-item-label">Cadence</div>
                            <div class="stat-item-value">150 - 155 spm</div>
                        </div>
                    </div>

                    <div class="info-box" style="border-left-color: var(--whoop-blue);">
                        <strong style="color: white;">üí° Key Learning</strong><br>
                        ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ß‡∏¥‡πà‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á 40-60 ‡∏ô‡∏≤‡∏ó‡∏µ‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö‡∏´‡∏ô‡∏±‡∏Å, ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∏‡∏° HR ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô
                    </div>
                </div>
            </div>

            <!-- PHASE 0: COMPLETED -->
            <div class="accordion-card">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <div>
                        <div class="text-uppercase">üåë PHASE 0: COMPLETED (BEFORE AUG 2025)</div>
                        <h3 style="color: white;">Pre-Base (The Instinct Era)</h3>
                    </div>
                    <i class="fas fa-chevron-down accordion-icon"></i>
                </div>
                <div class="accordion-body">
                    <p class="text-justify" style="color: var(--text-sub); margin-bottom: 15px;">
                        <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ‡∏ß‡∏¥‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏ç‡∏≤‡∏ì (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ô‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô Training)<br>
                        ‡∏ä‡πà‡∏ß‡∏á‡∏•‡∏≠‡∏á‡∏ú‡∏¥‡∏î‡∏•‡∏≠‡∏á‡∏ñ‡∏π‡∏Å ‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡πÅ‡∏•‡∏∞‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö‡∏á‡πà‡∏≤‡∏¢
                    </p>
                    
                    <div class="stats-grid-row">
                        <div>
                            <div class="stat-item-label">Distance</div>
                            <div class="stat-item-value">3-5 km (< 40m)</div>
                        </div>
                        <div>
                            <div class="stat-item-label">HR Zone</div>
                            <div class="stat-item-value highlight-red">Zone 3-4 (Spike)</div>
                        </div>
                        <div>
                            <div class="stat-item-label">Cadence</div>
                            <div class="stat-item-value">N/A</div>
                        </div>
                    </div>

                    <div class="info-box" style="border-left-color: #333;">
                        <strong style="color: white;">üí° Key Learning</strong><br>
                        Shin Splints (‡πÄ‡∏à‡πá‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏Ç‡πâ‡∏á) ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Å‡πâ‡∏≤‡∏ß‡∏¢‡∏≤‡∏ß, ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á Zone ‡∏´‡∏±‡∏ß‡πÉ‡∏à
                    </div>
                </div>
            </div>
        </div>

        <!-- VIEW 2: SCHEDULE (SAME) -->
        <div id="schedule" class="section-view">
            <div class="header-section">
                <div>
                    <div class="text-uppercase">TRAINING PLAN</div>
                    <h1 class="page-title">Weekly Schedule</h1>
                    <div class="subtitle">Timeline Planning</div>
                </div>
            </div>

            <div class="timeline-nav">
                <div class="timeline-year">2026</div>
                <button class="timeline-btn month-active">JAN</button>
                <button class="timeline-btn">FEB</button>
                <button class="timeline-btn">MAR</button>
                <div style="width:1px; background:#333; margin:0 5px;"></div>
                <button class="timeline-btn" onclick="selectWeek(1)">Week 1<br><span style="font-size:8px;">1-4</span></button>
                <button class="timeline-btn" onclick="selectWeek(2)">Week 2<br><span style="font-size:8px;">5-11</span></button>
                <button class="timeline-btn" onclick="selectWeek(3)">Week 3<br><span style="font-size:8px;">12-18</span></button>
                <button class="timeline-btn active" onclick="selectWeek(4)">Week 4<br><span style="font-size:8px;">19-25</span></button>
                <button class="timeline-btn" onclick="selectWeek(5)">Week 5<br><span style="font-size:8px;">26-31</span></button>
            </div>

            <div class="accordion-card open" style="border: 1px solid var(--border-color); cursor: default;">
                <table class="schedule-table">
                    <thead>
                        <tr>
                            <th width="15%">Day / Date</th>
                            <th width="35%">Detail + HR Zone</th>
                            <th width="25%">Focus & Technique</th>
                            <th width="25%">Supplements & Strength</th>
                        </tr>
                    </thead>
                    <tbody id="scheduleTableBody"></tbody>
                </table>
            </div>
        </div>

        <!-- VIEW 3: HANDBOOK (SAME) -->
        <div id="handbook" class="section-view">
            <div class="header-section">
                <div>
                    <div class="text-uppercase">KNOWLEDGE BASE</div>
                    <h1 class="page-title">Handbook & Gear</h1>
                    <div class="subtitle">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏ã‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏à</div>
                </div>
            </div>

            <div class="handbook-layout">
                <div class="accordion-card open" style="height: fit-content; margin-bottom:0;">
                    <div class="accordion-header" style="border-bottom: 1px solid var(--border-color);">
                        <h3 style="margin:0;">1. Identity & Philosophy</h3>
                    </div>
                    <div style="padding: 20px;">
                        <p style="color: var(--text-main); font-weight: 500;">Type: Cognitive-Associative Learner</p>
                        <p style="font-size: 13px; color: var(--text-sub); margin-bottom: 15px;">
                            ‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡πà‡∏á‡∏™‡∏≤‡∏¢ "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à" ‡πÅ‡∏¢‡∏Å‡πÅ‡∏¢‡∏∞ Pain vs Fatigue ‡πÑ‡∏î‡πâ‡∏î‡∏µ
                        </p>
                        <div style="background: #1A1A1A; padding: 15px; border-radius: 8px;">
                            <strong style="color: var(--whoop-blue);">Core Rules:</strong>
                            <ul style="font-size: 13px; color: var(--text-sub); margin-top: 5px; list-style: inside;">
                                <li>Base > Speed (‡∏ê‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ô‡πà‡∏ô‡∏Å‡πà‡∏≠‡∏ô)</li>
                                <li>HR > Pace (‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏ô‡∏≥‡∏ó‡∏≤‡∏á)</li>
                                <li>Feeling > Numbers (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏ß‡πà‡∏≤)</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="accordion-card open" style="height: fit-content; margin-bottom:0;">
                    <div class="accordion-header" style="border-bottom: 1px solid var(--border-color);">
                        <h3 style="margin:0;">2. Gear & Maintenance</h3>
                    </div>
                    <div style="padding: 20px;">
                        <div style="margin-bottom: 15px;">
                            <div class="text-uppercase" style="margin-bottom:10px; display:flex; justify-content:space-between;">
                                <span>CURRENT SHOES</span>
                                <span style="color:var(--text-sub); font-size:9px;">UPDATED: 25 JAN 2026 (WEEK 1 END)</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 5px;">
                                <div>
                                    <span style="color: white; font-weight:bold; font-size:16px;">Nike Vomero Plus</span>
                                    <div style="font-size:10px; color:#666; margin-top:2px;">
                                        Base: 621 km + <span style="color:var(--whoop-green);">Week 1 (~31 km)</span>
                                    </div>
                                </div>
                                <span class="highlight-yellow" style="font-weight: bold; font-size: 20px;">652 <span style="font-size:12px; color:#888;">/ 1000 km</span></span>
                            </div>
                            <div style="margin-top: 10px;">
                                <div style="display: flex; justify-content: space-between; font-size: 11px; color: #888; margin-bottom: 5px;">
                                    <span>0 km</span>
                                    <span>Limit: 1000 km</span>
                                </div>
                                <div style="width: 100%; height: 12px; background: #222; border-radius: 6px; overflow: hidden; border: 1px solid #333; position: relative;">
                                    <div style="position: absolute; left: 0; width: 50%; height: 100%; background: rgba(52, 211, 153, 0.15);"></div>
                                    <div style="position: absolute; left: 50%; width: 30%; height: 100%; background: rgba(251, 191, 36, 0.15);"></div>
                                    <div style="position: absolute; left: 80%; width: 20%; height: 100%; background: rgba(248, 113, 113, 0.15);"></div>
                                    
                                    <!-- Progress Bar calculated at 65.2% -->
                                    <div style="width: 65.2%; height: 100%; background: var(--whoop-yellow); position: relative; border-radius: 6px 0 0 6px;">
                                        <div style="position: absolute; right: 0; top: 0; bottom: 0; width: 2px; background: white; box-shadow: 0 0 5px white;"></div>
                                    </div>
                                </div>
                                <div style="text-align: right; font-size: 11px; color: var(--whoop-yellow); margin-top: 5px;">
                                    Status: Warning Zone (65%) - ‡∏û‡∏∑‡πâ‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏Ç‡πá‡∏á
                                </div>
                            </div>
                        </div>
                        <hr style="border-color: #333; margin: 15px 0;">
                        <div>
                            <div class="text-uppercase">WEAK LINKS</div>
                            <ul style="font-size: 13px; color: var(--text-sub); list-style: none;">
                                <li>‚ö†Ô∏è <strong>‡∏ô‡πà‡∏≠‡∏á/‡∏Ç‡∏≤‡∏´‡∏ô‡∏µ‡∏ö:</strong> ‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏£‡∏∞‡πÅ‡∏ó‡∏ô‡∏Å‡πâ‡∏ô</li>
                                <li>‚ö†Ô∏è <strong>‡∏™‡∏∞‡πÇ‡∏û‡∏Å‡∏ã‡πâ‡∏≤‡∏¢:</strong> Inactive History</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="accordion-card open handbook-full-width" style="margin-bottom:0;">
                    <div class="accordion-header" style="border-bottom: 1px solid var(--border-color);">
                        <h3 style="margin:0;">3. Dynamic HR Zones (Max: 168)</h3>
                    </div>
                    <div style="padding: 20px;">
                        <div style="background: #0f0f0f; padding: 15px; border-radius: 12px; border: 1px solid #222; margin-bottom: 25px;">
                            <canvas id="zoneChart" style="max-height: 120px;"></canvas>
                        </div>
                        <table class="hr-table">
                            <thead>
                                <tr><th>‡πÇ‡∏ã‡∏ô (Zone)</th><th>‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ó‡∏§‡∏©‡∏é‡∏µ</th><th>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏à‡∏£‡∏¥‡∏á (Real Feel)</th><th>‡πÇ‡∏ã‡∏ô‡∏ù‡∏∂‡∏Å‡∏à‡∏£‡∏¥‡∏á (Final)</th></tr>
                            </thead>
                            <tbody>
                                <tr><td style="color:#60A5FA;"><span class="hr-zone-tag">Z1: Recovery</span>(‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π/‡∏ß‡∏≠‡∏£‡πå‡∏°)</td><td>115 - 130 bpm</td><td>‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏ô ‡πÄ‡∏£‡πá‡∏ß‡πÑ‡∏õ‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡πá‡∏´‡∏•‡∏∏‡∏î</td><td><span class="highlight-green">< 138 bpm</span><br><span style="font-size:10px; color:#666;">(‡πÉ‡∏ä‡πâ‡∏ß‡∏±‡∏ô‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå)</span></td></tr>
                                <tr><td style="color:#34D399;"><span class="hr-zone-tag">Z2: Aerobic Base</span>(‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô/‡πÄ‡∏ú‡∏≤‡πÑ‡∏Ç‡∏°‡∏±‡∏ô)</td><td>131 - 150 bpm</td><td><strong>Sweet Spot!</strong><br>145-148 ‡πÑ‡∏´‡∏•‡∏•‡∏∑‡πà‡∏ô ‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢‡∏´‡∏≠‡∏ö</td><td><span class="highlight-green">138 - 152 bpm</span><br><span style="font-size:10px; color:#666;">(‡πÉ‡∏ä‡πâ‡∏ß‡∏±‡∏ô‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£/‡πÄ‡∏™‡∏≤‡∏£‡πå)</span></td></tr>
                                <tr><td style="color:#FBBF24;"><span class="hr-zone-tag">Z3: Aerobic Power</span>(‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô)</td><td>151 - 169 bpm</td><td>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏∂‡∏á‡∏Ç‡∏≤ ‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡πÅ‡∏£‡∏á‡πÅ‡∏ï‡πà‡∏Ñ‡∏∏‡∏°‡πÑ‡∏î‡πâ</td><td><span class="highlight-yellow">153 - 160 bpm</span><br><span style="font-size:10px; color:#666;">(‡πÉ‡∏ä‡πâ‡∏ä‡πà‡∏ß‡∏á‡∏™‡∏±‡πâ‡∏ô‡πÜ ‡πÉ‡∏ô Strides)</span></td></tr>
                                <tr><td style="color:#F87171;"><span class="hr-zone-tag">Z4-Z5: Threshold</span>(‡∏Ç‡∏µ‡∏î‡∏à‡∏≥‡∏Å‡∏±‡∏î)</td><td>> 170 bpm</td><td><strong>Red Zone</strong><br>‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏™‡∏µ‡∏¢ ‡∏Ç‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡∏≤‡∏Å</td><td><span class="highlight-red">> 165 bpm</span><br><span style="font-size:10px; color:#666;">(‡∏´‡πâ‡∏≤‡∏°‡πÅ‡∏ä‡πà‡πÄ‡∏Å‡∏¥‡∏ô 1 ‡∏ô‡∏≤‡∏ó‡∏µ)</span></td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- VIEW 4: RECOVERY ROOM (SAME) -->
        <div id="recovery" class="section-view">
             <div class="header-section">
                <div>
                    <div class="text-uppercase">MAINTENANCE</div>
                    <h1 class="page-title">Recovery Room</h1>
                    <div class="subtitle">‡πÅ‡∏ú‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</div>
                </div>
            </div>

            <!-- Essential Tools -->
            <div class="accordion-card open">
                <div class="accordion-header">
                    <h3 style="margin:0;">üõ†Ô∏è Essential Tools</h3>
                </div>
                <div style="padding: 20px;">
                    <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                        <div style="flex: 1; min-width: 200px; background: #1a1a1a; padding: 15px; border-radius: 8px;">
                            <strong style="color: white; display: block; margin-bottom: 5px;">1. Foam Roller</strong>
                            <p style="font-size: 13px; color: var(--text-sub);">
                                ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏°‡∏±‡∏î‡πÉ‡∏´‡∏ç‡πà (‡∏´‡∏ô‡πâ‡∏≤‡∏Ç‡∏≤, ‡∏ô‡πà‡∏≠‡∏á, IT Band) ‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏∂‡∏á‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏•‡∏±‡∏á‡∏ã‡πâ‡∏≠‡∏°
                            </p>
                        </div>
                        <div style="flex: 1; min-width: 200px; background: #1a1a1a; padding: 15px; border-radius: 8px;">
                            <strong style="color: white; display: block; margin-bottom: 5px;">2. Massage Ball</strong>
                            <p style="font-size: 13px; color: var(--text-sub);">
                                ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏•‡∏∂‡∏Å (Deep Tissue) ‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡πâ‡∏ô (Glutes), ‡∏ù‡πà‡∏≤‡πÄ‡∏ó‡πâ‡∏≤ (Plantar), ‡πÅ‡∏•‡∏∞‡∏™‡∏∞‡∏ö‡∏±‡∏Å
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Routine Plans -->
            <div class="recovery-grid">
                <!-- Pre-Run -->
                <div class="recovery-card">
                    <div class="recovery-title"><i class="fas fa-play-circle" style="color: #60A5FA;"></i> Pre-Run Activation</div>
                    <div style="font-size: 12px; color: #888; margin-bottom: 10px;">‡∏õ‡∏•‡∏∏‡∏Å‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡∏¥‡πà‡∏á (‡∏´‡πâ‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏Ñ‡πâ‡∏≤‡∏á)</div>
                    <ul class="recovery-list">
                        <li><i class="fas fa-check"></i> <strong>Leg Swings:</strong> ‡πÅ‡∏Å‡∏ß‡πà‡∏á‡∏Ç‡∏≤‡∏´‡∏ô‡πâ‡∏≤-‡∏´‡∏•‡∏±‡∏á 15 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏Ç‡πâ‡∏≤‡∏á</li>
                        <li><i class="fas fa-check"></i> <strong>Toe Yoga:</strong> ‡∏¢‡∏Å‡∏ô‡∏¥‡πâ‡∏ß‡πÇ‡∏õ‡πâ‡∏á‡∏™‡∏•‡∏±‡∏ö‡∏ô‡∏¥‡πâ‡∏ß‡∏Å‡πâ‡∏≠‡∏¢ (‡∏õ‡∏•‡∏∏‡∏Å‡πÄ‡∏ó‡πâ‡∏≤)</li>
                        <li><i class="fas fa-check"></i> <strong>Glute Bridges:</strong> ‡∏î‡∏±‡∏ô‡∏™‡∏∞‡πÇ‡∏û‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô 15 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á (‡∏õ‡∏•‡∏∏‡∏Å‡∏Å‡πâ‡∏ô)</li>
                        <li><i class="fas fa-check"></i> <strong>Walking Lunges:</strong> ‡πÄ‡∏î‡∏¥‡∏ô‡∏¢‡πà‡∏≠‡πÄ‡∏Ç‡πà‡∏≤ 10 ‡∏Å‡πâ‡∏≤‡∏ß</li>
                    </ul>
                </div>

                <!-- Post-Run -->
                <div class="recovery-card">
                    <div class="recovery-title"><i class="fas fa-stop-circle" style="color: #34D399;"></i> Post-Run Reset</div>
                    <div style="font-size: 12px; color: #888; margin-bottom: 10px;">‡∏Ñ‡∏•‡∏≤‡∏¢‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πà‡∏á</div>
                    <ul class="recovery-list">
                        <li><i class="fas fa-check"></i> <strong>Calf Stretch:</strong> ‡∏î‡∏±‡∏ô‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡∏¢‡∏∑‡∏î‡∏ô‡πà‡∏≠‡∏á ‡∏Ñ‡πâ‡∏≤‡∏á 45 ‡∏ß‡∏¥</li>
                        <li><i class="fas fa-check"></i> <strong>Hamstring Stretch:</strong> ‡∏û‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÅ‡∏ï‡∏∞‡∏õ‡∏•‡∏≤‡∏¢‡πÄ‡∏ó‡πâ‡∏≤ ‡∏Ñ‡πâ‡∏≤‡∏á 30 ‡∏ß‡∏¥</li>
                        <li><i class="fas fa-check"></i> <strong>Foam Roll Calves:</strong> ‡∏Å‡∏•‡∏¥‡πâ‡∏á‡∏ô‡πà‡∏≠‡∏á‡πÄ‡∏ö‡∏≤‡πÜ (‡∏´‡∏≤‡∏à‡∏∏‡∏î‡∏ï‡∏∂‡∏á)</li>
                        <li><i class="fas fa-check"></i> <strong>Quads Roll:</strong> ‡∏Å‡∏•‡∏¥‡πâ‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏Ç‡∏≤</li>
                    </ul>
                </div>

                <!-- Deep Recovery -->
                <div class="recovery-card">
                    <div class="recovery-title"><i class="fas fa-bed" style="color: #F87171;"></i> Deep Recovery (Rest Day)</div>
                    <div style="font-size: 12px; color: #888; margin-bottom: 10px;">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏∏‡∏î‡∏ï‡∏∂‡∏á‡∏™‡∏∞‡∏™‡∏°</div>
                    <ul class="recovery-list">
                        <li><i class="fas fa-check"></i> <strong>Ball Smash Glutes:</strong> ‡∏ô‡∏±‡πà‡∏á‡∏ó‡∏±‡∏ö‡∏ö‡∏≠‡∏•‡∏ï‡∏£‡∏á‡πÅ‡∏Å‡πâ‡∏°‡∏Å‡πâ‡∏ô (‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏à‡πá‡∏ö)</li>
                        <li><i class="fas fa-check"></i> <strong>Foot Roll:</strong> ‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö‡∏ö‡∏≠‡∏•‡∏Å‡∏•‡∏¥‡πâ‡∏á‡πÉ‡∏ï‡πâ‡∏ù‡πà‡∏≤‡πÄ‡∏ó‡πâ‡∏≤</li>
                        <li><i class="fas fa-check"></i> <strong>Pigeon Pose:</strong> ‡∏ó‡πà‡∏≤‡∏ô‡∏Å‡∏û‡∏¥‡∏£‡∏≤‡∏ö (‡∏¢‡∏∑‡∏î‡∏™‡∏∞‡πÇ‡∏û‡∏Å‡∏•‡∏∂‡∏Å)</li>
                        <li><i class="fas fa-check"></i> <strong>Legs Up Wall:</strong> ‡∏¢‡∏Å‡∏Ç‡∏≤‡∏û‡∏≤‡∏î‡∏Å‡∏≥‡πÅ‡∏û‡∏á 10 ‡∏ô‡∏≤‡∏ó‡∏µ</li>
                    </ul>
                </div>
            </div>

            <!-- AI Physio -->
            <div class="accordion-card" style="padding: 25px; margin-top: 30px;">
                <div style="margin-bottom: 20px;">
                    <span class="text-uppercase" style="color: var(--whoop-green);"><i class="fas fa-user-md" style="font-size:12px;"></i> AI Physio Partner</span>
                    <p style="font-size: 13px; color: var(--text-sub); margin-top: 5px;">
                        ‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏∂‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏à‡∏∏‡∏î? ‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏ß‡∏¥‡∏ò‡∏µ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
                    </p>
                </div>
                <textarea id="physioInput" class="form-input" rows="3" placeholder="Ex: ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ï‡∏∂‡∏á‡πÄ‡∏≠‡πá‡∏ô‡∏£‡πâ‡∏≠‡∏¢‡∏´‡∏ß‡∏≤‡∏¢‡∏°‡∏≤‡∏Å ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏ô?"></textarea>
                <button class="btn-sparkle" onclick="askPhysioAI()" style="margin-top: 10px; width: auto; padding: 10px 30px;">
                    <i class="fas fa-comment-medical"></i> Consult
                </button>
                <div id="physioResult" style="margin-top: 25px; border-top: 1px solid var(--border-color); padding-top: 20px; display: none; line-height: 1.6; color: var(--text-main);"></div>
            </div>
        </div>

        <!-- VIEW 5: DAILY LOG (SAME) -->
        <div id="dailylog" class="section-view">
            <div class="header-section">
                <div>
                    <div class="text-uppercase">TRACKING</div>
                    <h1 class="page-title">Daily Log</h1>
                    <div class="subtitle">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏ã‡πâ‡∏≠‡∏° (‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)</div>
                </div>
            </div>

            <div class="accordion-card" style="padding: 25px; overflow: visible;">
                <div class="log-form-grid">
                    <div>
                        <label style="font-size:11px; color:#666; display:block; margin-bottom:5px;">DATE</label>
                        <input type="date" id="logDate" class="form-input">
                    </div>
                    <div>
                        <label style="font-size:11px; color:#666; display:block; margin-bottom:5px;">TYPE</label>
                        <select id="logType" class="form-input" style="background:#1A1A1A; color:white; border:1px solid #333;">
                            <option value="Run">Running</option>
                            <option value="Strength">Strength/Gym</option>
                            <option value="Rest">Rest Day</option>
                        </select>
                    </div>
                    <div>
                        <label style="font-size:11px; color:#666; display:block; margin-bottom:5px;">DIST (KM)</label>
                        <input type="number" id="logDist" class="form-input" placeholder="0.0">
                    </div>
                    <div>
                        <label style="font-size:11px; color:#666; display:block; margin-bottom:5px;">TIME (MIN)</label>
                        <input type="number" id="logTime" class="form-input" placeholder="0">
                    </div>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="font-size:11px; color:#666; display:block; margin-bottom:5px;">NOTES / FEELING</label>
                    <textarea id="logNote" class="form-input" rows="2" placeholder="Ex: ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏î‡∏µ ‡∏Ç‡∏≤‡∏´‡∏ô‡∏µ‡∏ö‡∏ï‡∏∂‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏ä‡πà‡∏ß‡∏á‡∏ó‡πâ‡∏≤‡∏¢..."></textarea>
                </div>
                <button onclick="saveLog()" class="btn-save">SAVE LOG</button>
            </div>

            <div style="margin-top: 30px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span class="text-uppercase">RECENT HISTORY</span>
                    <span style="font-size:10px; color:var(--whoop-red); cursor:pointer;" onclick="clearLogs()">CLEAR ALL</span>
                </div>
                <div id="logHistoryContainer"></div>
            </div>
        </div>

        <!-- VIEW 6: AI COACH (SAME) -->
        <div id="ai-coach" class="section-view">
            <div class="header-section">
                <div>
                    <div class="text-uppercase">INTELLIGENCE</div>
                    <h1 class="page-title">AI Coach</h1>
                </div>
            </div>
            <div class="accordion-card" style="padding: 25px;">
                <div style="margin-bottom: 20px;">
                    <span class="text-uppercase" style="color: var(--whoop-green);"><i class="fas fa-circle" style="font-size:8px;"></i> SYSTEM ACTIVE</span>
                    <p style="font-size: 13px; color: var(--text-sub); margin-top: 5px;">
                        ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Daily Log ‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (Phase 2)
                    </p>
                </div>
                <textarea id="ai-input" class="form-input" rows="4" placeholder="‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏£, ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Log..."></textarea>
                <div style="text-align: right; margin-top: 15px;">
                    <button onclick="askGemini()" id="ai-btn" class="btn-save" style="width: auto; padding: 10px 30px;">ANALYZE</button>
                </div>
                <div id="ai-result" style="margin-top: 25px; border-top: 1px solid var(--border-color); padding-top: 20px; display: none; line-height: 1.6; color: var(--text-main);"></div>
            </div>
        </div>

    </div>

    <script>
        // --- DATA & LOGIC FOR SCHEDULE ---
        const scheduleWeek4 = `
            <tr><td><strong style="color:white; font-size:16px;">MON 19</strong><br><span class="tag tag-rest">Rest</span></td><td><strong style="color:white;">System Reboot</strong><br>‡∏û‡∏±‡∏Å 100% (Passive Rest)<br><span style="font-size:12px;">‡∏á‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡∏±‡∏Å ‡πÉ‡∏´‡πâ‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°</span></td><td>‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢</td><td><div><i class="fas fa-socks"></i> Toe Yoga</div><div style="font-size:12px; margin-top:5px;">(‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ô‡∏¥‡πâ‡∏ß‡πÄ‡∏ó‡πâ‡∏≤ 5 ‡∏ô‡∏≤‡∏ó‡∏µ)</div></td></tr>
            <tr><td><strong style="color:white; font-size:16px;">TUE 20</strong><br><span class="tag tag-run">Tech Run</span></td><td><strong style="color:white;">Hip Calibration</strong><br>‡∏ß‡∏¥‡πà‡∏á 50 ‡∏ô‡∏≤‡∏ó‡∏µ (HR 145-148 bpm)<br><span style="font-size:12px; color:var(--whoop-green);">Zone 2-3 Stability</span></td><td><span class="highlight-green">Hip Drive Focus</span><br>‡∏î‡∏∂‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏•‡∏á‡πÉ‡∏ï‡πâ‡∏™‡∏∞‡πÇ‡∏û‡∏Å<br><span class="highlight-red" style="font-size:12px;">*‡∏ñ‡πâ‡∏≤‡∏ô‡πà‡∏≠‡∏á‡∏ï‡∏∂‡∏á = ‡∏•‡∏á‡∏ú‡∏¥‡∏î</span></td><td><div><i class="fas fa-dumbbell"></i> Short Foot Ex.</div><div><i class="fas fa-tint"></i> ‡∏ô‡πâ‡∏≥‡∏ó‡∏∏‡∏Å 2 ‡∏Å‡∏°.</div></td></tr>
            <tr><td><strong style="color:white; font-size:16px;">WED 21</strong><br><span class="tag tag-run">Quality</span></td><td><strong style="color:white;">Neural Ignition</strong><br>Easy 40 min + 6 Strides<br><span style="font-size:12px;">(Strides: ‡πÄ‡∏£‡πà‡∏á 20‡∏ß‡∏¥ / ‡∏û‡∏±‡∏Å 40‡∏ß‡∏¥)</span></td><td><strong>Lock Ankle</strong><br>‡∏•‡πá‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πâ‡∏≤‡πÅ‡∏Ç‡πá‡∏á‡∏Ç‡∏ì‡∏∞‡∏î‡∏µ‡∏î‡∏ï‡∏±‡∏ß</td><td><div class="highlight-red"><i class="fas fa-exclamation-circle"></i> ‡∏¢‡∏∑‡∏î‡∏ô‡πà‡∏≠‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ 2 ‡∏ô‡∏≤‡∏ó‡∏µ</div><div style="font-size:12px;">(‡∏´‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡∏´‡πâ‡∏≤‡∏°‡∏Ç‡∏≤‡∏î)</div></td></tr>
            <tr><td><strong style="color:white; font-size:16px;">THU 22</strong><br><span class="tag tag-rest">Busy</span></td><td><strong style="color:white;">Rest (‡∏ò‡∏∏‡∏£‡∏∞)</strong><br>‡∏á‡∏î‡∏ã‡πâ‡∏≠‡∏°‡∏ß‡∏¥‡πà‡∏á</td><td><strong>Active Sitting</strong><br>‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏•‡∏∏‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏∏‡∏Å 1 ‡∏ä‡∏°.</td><td><div><i class="fas fa-shield-alt"></i> Plank 3 sets</div><div style="font-size:12px;">(45 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ/‡πÄ‡∏ã‡πá‡∏ï)</div></td></tr>
            <tr><td><strong style="color:white; font-size:16px;">FRI 23</strong><br><span class="tag tag-rest">Busy</span></td><td><strong style="color:white;">Rest (‡∏ò‡∏∏‡∏£‡∏∞)</strong><br>‡∏á‡∏î‡∏ã‡πâ‡∏≠‡∏°‡∏ß‡∏¥‡πà‡∏á</td><td><span class="highlight-red">Inactive Glute Alert</span><br>‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Å‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏ö</td><td><strong style="color:var(--whoop-yellow);">MUST DO:</strong><br>- Band Clamshells<br>- Side Leg Raises<br>(3 Sets x 15 Reps)</td></tr>
            <tr><td><strong style="color:white; font-size:16px;">SAT 24</strong><br><span class="tag tag-long">Long Run</span></td><td><strong style="color:white;">Endurance Build</strong><br>95-100 ‡∏ô‡∏≤‡∏ó‡∏µ (HR 142-145)<br><span style="font-size:12px;">‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏¥‡πà‡∏á ‡∏´‡πâ‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏ä‡∏≤‡∏Å</span></td><td><strong>Fatigue Mngt.</strong><br>‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡πâ‡∏≤: ‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏´‡∏•‡πà + ‡∏Å‡∏î‡∏ô‡∏¥‡πâ‡∏ß‡πÇ‡∏õ‡πâ‡∏á</td><td><div>‚ö° <strong>Gel (100kcal):</strong> ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà 40 & 80</div><div>üíß ‡∏ô‡πâ‡∏≥‡∏ó‡∏∏‡∏Å 2.5 ‡∏Å‡∏°.</div></td></tr>
            <tr><td><strong style="color:white; font-size:16px;">SUN 25</strong><br><span class="tag tag-run">Recov</span></td><td><strong style="color:white;">Active Recovery</strong><br>Jog 30-40 ‡∏ô‡∏≤‡∏ó‡∏µ (HR < 138)<br><span style="font-size:12px;">‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏ö‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏î‡πâ</span></td><td><strong>Silent Running</strong><br>‡∏•‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</td><td><div>üßò Full Body Stretch</div><div>üîÑ Foam Roll (All Legs)</div></td></tr>
        `;

        function selectWeek(weekNum) {
            const tbody = document.getElementById('scheduleTableBody');
            const btns = document.querySelectorAll('.timeline-btn');
            
            // Handle Active State
            btns.forEach(btn => {
                if (btn.innerText.includes('Week')) {
                    btn.classList.remove('active');
                    if (btn.innerText.includes('Week ' + weekNum)) btn.classList.add('active');
                }
            });

            // Handle Content
            if (weekNum === 4) {
                tbody.innerHTML = scheduleWeek4;
            } else {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align:center; padding:40px; color:#555;">
                            <i class="fas fa-calendar-times" style="font-size:24px; margin-bottom:10px;"></i><br>
                            NO TRAINING DATA FOR WEEK ${weekNum}<br>
                            <span style="font-size:12px;">(Select Week 4 for Jan 19-25)</span>
                        </td>
                    </tr>
                `;
            }
        }

        // Initialize Schedule
        selectWeek(4);

        // --- 1. NAVIGATION & UI ---
        function switchTab(tabId, element) {
            document.querySelectorAll('.section-view').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            if(element) {
                element.classList.add('active');
            } else {
                if(tabId === 'dashboard') {
                    document.querySelector('.nav-item[onclick*="dashboard"]').classList.add('active');
                }
            }

            if(tabId === 'handbook') { setTimeout(renderChart, 100); }
        }

        function toggleAccordion(element) {
            element.parentElement.classList.toggle('open');
            const body = element.parentElement.querySelector('.accordion-body');
            body.style.display = element.parentElement.classList.contains('open') ? 'block' : 'none';
        }

        // --- 2. CHART.JS (HANDBOOK) ---
        let zoneChartInstance = null;
        function renderChart() {
            const ctx = document.getElementById('zoneChart').getContext('2d');
            if (zoneChartInstance) return;
            zoneChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Z1 (Recov)', 'Z2 (Base)', 'Z3 (Power)', 'Z4-Z5 (Max)'],
                    datasets: [{
                        label: 'Heart Rate Range (BPM)',
                        data: [
                            [115, 130], // Z1
                            [131, 150], // Z2
                            [151, 169], // Z3
                            [170, 188]  // Z4-Z5
                        ],
                        backgroundColor: [
                            'rgba(96, 165, 250, 0.7)', // Blue Z1
                            'rgba(52, 211, 153, 0.7)', // Green Z2
                            'rgba(251, 191, 36, 0.7)', // Yellow Z3
                            'rgba(248, 113, 113, 0.7)' // Red Z4-Z5
                        ],
                        borderColor: [
                            '#60A5FA', '#34D399', '#FBBF24', '#F87171'
                        ],
                        borderWidth: 1,
                        borderRadius: 6,
                        barPercentage: 0.6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y', // Horizontal bars
                    scales: {
                        x: { 
                            min: 100, 
                            max: 190, 
                            grid: { color: '#333' },
                            ticks: { color: '#888' }
                        },
                        y: { 
                            ticks: { color: '#E5E5E5', font: {size: 11} }, 
                            grid: { display: false } 
                        }
                    },
                    plugins: { 
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Range: ${context.raw[0]} - ${context.raw[1]} bpm`;
                                }
                            }
                        }
                    }
                }
            });
        }

        // --- 3. LOCAL STORAGE ---
        const STORAGE_KEY = 'runner_001_logs_v2';
        document.getElementById('logDate').valueAsDate = new Date();

        function getLogs() { return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); }
        
        function saveLog() {
            const date = document.getElementById('logDate').value;
            const type = document.getElementById('logType').value;
            const dist = document.getElementById('logDist').value;
            const time = document.getElementById('logTime').value;
            const note = document.getElementById('logNote').value;

            if (!date) return alert("Please select date");

            const logs = getLogs();
            logs.unshift({ id: Date.now(), date, type, dist, time, note });
            localStorage.setItem(STORAGE_KEY, JSON.stringify(logs));
            
            document.getElementById('logDist').value = '';
            document.getElementById('logTime').value = '';
            document.getElementById('logNote').value = '';
            renderLogs();
        }

        function deleteLog(id) {
            if(!confirm("Delete?")) return;
            const logs = getLogs().filter(l => l.id !== id);
            localStorage.setItem(STORAGE_KEY, JSON.stringify(logs));
            renderLogs();
        }

        function clearLogs() {
            if(confirm("Clear ALL logs?")) { localStorage.removeItem(STORAGE_KEY); renderLogs(); }
        }

        function renderLogs() {
            const logs = getLogs();
            const container = document.getElementById('logHistoryContainer');
            if (logs.length === 0) { container.innerHTML = '<div style="text-align:center; color:#555; padding:20px;">No logs yet.</div>'; return; }
            
            container.innerHTML = logs.map(log => `
                <div class="log-history-item" style="border-left-color: ${log.type === 'Run' ? '#34D399' : (log.type === 'Strength' ? '#FBBF24' : '#555')}">
                    <div style="flex-grow:1;">
                        <div style="font-size:12px; color:#888; margin-bottom:5px;">${log.date} | <span style="color:#fff; font-weight:600;">${log.type}</span></div>
                        <div style="color:white; font-size:15px;">${log.dist ? log.dist + ' km' : ''} ${log.time ? ' ‚Ä¢ ' + log.time + ' min' : ''}</div>
                        ${log.note ? `<div style="font-size:13px; color:#aaa; margin-top:5px; font-style:italic;">"${log.note}"</div>` : ''}
                    </div>
                    <button onclick="deleteLog(${log.id})" style="background:none; border:none; color:#444; cursor:pointer;"><i class="fas fa-trash"></i></button>
                </div>
            `).join('');
        }
        renderLogs();

        // --- 4. GENERAL AI ---
        const apiKey = ""; // API Key injected by environment

        async function askGemini() {
            const input = document.getElementById('ai-input').value;
            const resultDiv = document.getElementById('ai-result');
            const btn = document.getElementById('ai-btn');
            
            if (!input.trim()) return;

            btn.innerText = 'PROCESSING...'; btn.disabled = true;
            resultDiv.style.display = 'block'; resultDiv.innerHTML = '<span style="color:#666">Analyzing...</span>';

            const logs = getLogs().slice(0, 5);
            const context = `
                Role: Coach for RUNNER_001. Phase 2 (Neuro Awareness). Max HR 168.
                History: Shin splints (Phase 0), Flu (Phase 1).
                Current: Hip Drive focus. Injury: Calf/Groin. Shoes: 621km (Old).
                Recent Logs: ${JSON.stringify(logs)}
                Task: Answer in Thai.
            `;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: input }] }], systemInstruction: { parts: [{ text: context }] } })
                });
                const data = await response.json();
                resultDiv.innerHTML = data.candidates[0].content.parts[0].text.replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<strong style="color:white">$1</strong>');
            } catch (e) { resultDiv.innerHTML = "Error connecting to AI."; } 
            finally { btn.innerText = 'ANALYZE'; btn.disabled = false; }
        }

        // --- 5. AI PHYSIO (NEW) ---
        async function askPhysioAI() {
            const input = document.getElementById('physioInput').value;
            const resultDiv = document.getElementById('physioResult');
            
            if (!input.trim()) return;

            resultDiv.style.display = 'block'; resultDiv.innerHTML = '<span style="color:#666">Consulting Physio AI...</span>';

            const prompt = `
                Act as a Sports Physical Therapist. 
                Provide specific stretches, foam rolling techniques, or exercises for the user's issue.
                User Issue: "${input}"
                Context: Runner, tight calves/hips history.
                Format: Bullet points, Thai language. Concise instructions.
            `;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });
                const data = await response.json();
                resultDiv.innerHTML = data.candidates[0].content.parts[0].text.replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<strong style="color:#34D399">$1</strong>');
            } catch (e) { resultDiv.innerHTML = "Error connecting to AI."; }
        }
    </script>
</body>
</html>